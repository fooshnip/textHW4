<!DOCTYPE html>
<head>
<meta charset="utf-8">
<link href='/dist/css/bootstrap.css' rel='stylesheet' type='text/css'>
<link href='lavish-bootstrap.css' rel='stylesheet' type='text/css'>
<link href='http://fonts.googleapis.com/css?family=Yanone+Kaffeesatz:400' rel='stylesheet' type='text/css'>
<script src='/dist/js/bootstrap.min.js'></script>
<title>Movie Storyboarding</title>
<style>

/*#chart rect {
  fill: steelblue;
}*/

#chart text {
  fill: black;
  font: 10px sans-serif;
  text-anchor: end;
}
rect:hover {
	stroke: black;
}
p,h1,h2,h3,h4,h5,h6,label, a, text {
    font-family: "Yanone Kaffeesatz";
  }
body {
	background-color: white;
	background-image:url('toy_story.jpg');
	background-repeat: no-repeat;
	background-position: right;
	background-size: 20%;
	zoom: 1.1; -moz-transform: scale(1.1); -moz-transform-origin: 0 0;
}
.dialogue {
	shape-rendering: crispEdges;
}
</style>
</head>
<center><h2 align="center">Toy Story Storyboard</h2>
	<a href="findingnemo.html">To Finding Nemo!</a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="up.html">Head Over to Up!</a>
	<p style="font-size:16px">The following graphic was created in D3 and data parsed from a raw movie script of Toy Story, found from <a href="imsdb.com">The Internet Movie Script Database</a>.  Mouseover the chart to see the character's quotes over time.</p>
	<br>
</div class="speekdiv"></div>
<center><div id="chart" style="margin-left:-130px"></div>
<script src="http://d3js.org/d3.v3.min.js"></script>
<script src="data1.js"></script>
<script>

var width = 820,
    barHeight = 10;

var newi=[];
for(i=1;i<=44;i++){
	newi.push(i);
}

var x = d3.scale.ordinal()
    .domain(names)
    .range(newi);
var padding = 180;

var xAxis = d3.svg.axis()
    .scale(x)
    .orient("bottom");

storyboard(data,names);

function storyboard(data,names){

	var chart = d3.select("#chart")
		.append("svg")
	    .attr("width", width+padding)
	    .attr("height", 800)
	    .append("g")
	     .attr("transform", "translate(" + padding + "," + 0 + ")");;

	var bar = chart.selectAll("g")
	    .data(data)
	  .enter().append("g");

	bar.append("rect")
		.attr("transform", function(d, i) {return "translate("+0 +","+ x(d.name)*10+ ")"; })
		.attr("width", 10)
	    .attr("height", barHeight-1)
	    .attr("class",function(d){return "a"+d.index+"a"})
	    .attr("rx",5)
		.attr("ry",5)
		.style("fill", "lightgrey")
		.attr("transform", function(d, i) {return "translate("+d.index/1.15 +","+ x(d.name)*10 + ")"; });

	bar.append("rect")
		.attr("transform", function(d, i) {return "translate("+0 +","+ x(d.name)*10+ ")"; })
		.attr("width", 10)
	    .attr("height", barHeight-1)
	    .attr("class",function(d){return "a"+d.index+"a"})
	    .attr("rx",5)
		.attr("ry",5)
		.style("fill",function(d){if(d.name=='WOODY'||d.name=='BUZZ'){return "steelblue";}else if(d.name=='SID'){return "red";}else{return "grey";}})
		.transition()
		.delay(function(d, i) {
		    return i * 400;
				})
		.duration(2000)
		.attr("transform", function(d, i) {return "translate("+d.index/1.15 +","+ x(d.name)*10 + ")"; })
		.style("fill",function(d){if(d.name=='WOODY'||d.name=='BUZZ'){return "steelblue";}else if(d.name=='SID'){return "red";}else{return "grey";}})
		.style("stroke","gold")
		.attr("rx",5)
		.attr("ry",5)
		.style("fill-opacity",.4)
		.each("end", function(d,i) {d3.selectAll(".dialogue").remove();
									d3.selectAll(".faces").remove();
									bar.append("text")
									.attr("class","dialogue")
									.attr("x",780)
									.text(d.quote)
									.style("font-size","14px")
									.style("font-family","Open Sans")
									.attr("y",10);

									bar.select("rect")
									.style("stroke","transparent");

									 // bar.append("svg:image")
									 //  .attr("class","img-rounded faces")
								  //     .attr("xlink:href", "./pixtures/"+d.name.replace(":","")+".jpg")
								  //     .attr("x",600)
								  //     .attr("y",125)
								  //     .attr("rx",5)
									 //  .attr("ry",5)
								  //     .attr("width", 150)
								  //     .attr("height", 150);
									 });

	bar.append("title")
	    .text(function(d){return d.quote});

	chart2 = d3.select("svg")
				.data(data)
			    .attr("transform", function(d, i) {return "translate("+d.index +","+ x(d.name)*10 + ")"; });

	chart2.selectAll("text")
		.data(names)
		.enter().append("text")
		.attr("x",180)
		.attr("y",function(d,i){return i*10+19})
		.text(function(d){return d})
		.style("font-size","10px")
		.style("fill",function(d){if(d=='WOODY'||d=='BUZZ'){return "steelblue";}else if(d=='SID'){return "red";}else{return "grey";}})
		.style("font-family","Open Sans");

}

</script>
